section:
  OBJECTS[] =
    xml.o
    xmldump.o
    xmlparse_tab.o
    xmlscan.o

  .SCANNER: scan-%.cyc: xmlparse_tab.h

  libcycxml.so: $(OBJECTS) $(LIBCYC)
    cc -m32 $(OBJECTS) -o $@ -shared -Wl,-z,defs $(LDFLAGS) -lcyc

  .DEFAULT: libcycxml.so


section:
  OBJECTS[] =
    xmlecho.o

  LDFLAGS[] +=
    -L$(dir .)
    -Wl,-rpath,$(absname .)

  xmlecho: $(OBJECTS) $(LIBCYC) libcycxml.so
    cc -m32 $(OBJECTS) -o $@ $(LDFLAGS) -lcycxml -lcyc

  check: xmlecho test.xml
    xmlecho test.xml > test.xml.out
    diff test.xml test.xml.out
    rm test.xml.out

  .DEFAULT: xmlecho
